<!--
  Copyright (c) 2013-2018 Arm Ltd. All Rights Reserved.
  Arm Limited confidential and proprietary.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>wsf</title>
<title>Cordio Stack and Cordio Profiles: wsf</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="DoxygenStyleSheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo">&#160;<img alt="Logo" src="Arm_Cordio.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">&#160;&#160;&#160;Cordio Stack and Cordio Profiles
   &#160;<span id="projectnumber">r2p3-02rel0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="BLEnav" class="tabs1">
    <ol id="Tabs" class="tablist">
      <script type="text/javascript">
        <!--
        writeComponentTabs.call(this);
        //-->
      </script>
    </ol>
</div>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li class="current"><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___w_s_f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Content</a>  </div>
  <div class="headertitle">
<div class="title">wsf</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Content</h2></td></tr>
<tr class="memitem:group___w_s_f___a_s_s_e_r_t___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___a_s_s_e_r_t___a_p_i.html">WSF Assert API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___b_u_f___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___b_u_f___a_p_i.html">WSF Buffer API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___c_s___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___c_s___a_p_i.html">WSF Critical Section API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___e_f_s___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___e_f_s___a_p_i.html">WSF Embedded File System API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___m_a_t_h___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___m_a_t_h___a_p_i.html">WSF Math API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___m_s_g___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___m_s_g___a_p_i.html">WSF Message API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___o_s___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___o_s___a_p_i.html">WSF OS API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___q_u_e_u_e___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___q_u_e_u_e___a_p_i.html">WSF Queue API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___t_i_m_e_r___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___t_i_m_e_r___a_p_i.html">WSF Timer API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___t_r_a_c_e___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___t_r_a_c_e___a_p_i.html">WSF Trace API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___t_y_p_e_s"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___t_y_p_e_s.html">WSF Data Types</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___w_s_f___u_t_i_l___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___w_s_f___u_t_i_l___a_p_i.html">WSF Utility API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<h1><a class="anchor" id="WSF_INTRO"></a>
Introduction</h1>
<p>The Wireless Software Foundation (WSF) is a simple OS wrapper, porting layer, and general-purpose software service used by the Cordio embedded software system. The goal of WSF is to stay small and lean, supporting only the basic services required by the system. It consists of the following:</p><ul>
<li><a class="el" href="group___w_s_f.html#WSF_DATATYPES">Portable Data Types</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_BUFFERS">Dynamic Buffer Service</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_QUEUES">Queue Management</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_MESSAGES">Messages Passing</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_TIMERS">Timers</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_EVENTS">Event Handlers</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_CS">Critical Sections</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_SCHEDULING">Task Schedule Locking</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_ASSERT">Assert</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_TRACE">Trace</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_EFS">Embedded File System</a></li>
<li><a class="el" href="group___w_s_f.html#WSF_UTIL">Utilities</a></li>
</ul>
<p>WSF does not define any tasks but defines some interfaces to tasks. It relies on the target OS to implement tasks and manage the timer and event handler services from target OS tasks. WSF can also act as a simple standalone OS in software systems without an existing OS.</p>
<h1><a class="anchor" id="WSF_DATATYPES"></a>
Portable Data Types</h1>
<p>WSF defines the following portable data types in file <a class="el" href="wsf__types_8h.html" title="Platform-independent data types. ">wsf_types.h</a>. These data types are used throughout the software system.<br />
<br />
 See <a class="el" href="group___w_s_f___t_y_p_e_s.html">WSF Data Types</a> for more detail.</p>
<h1><a class="anchor" id="WSF_BUFFERS"></a>
Dynamic Buffer Service</h1>
<p>The WSF buffer management service is a pool-based dynamic memory allocation service. The buffer service interface is defined in file <a class="el" href="wsf__buf_8h.html" title="Buffer pool service. ">wsf_buf.h</a>.<br />
<br />
 See <a class="el" href="group___w_s_f___b_u_f___a_p_i.html">WSF Buffer API</a> for more detail.</p>
<h2><a class="anchor" id="WSF_BUFFERS_TEST"></a>
Buffer Tuning</h2>
<p><a class="el" href="group___w_s_f___b_u_f___a_p_i.html#gabbcaca59a0d42049fa29ccbae12324ba" title="Diagnostic function to get the buffer allocation statistics. ">WsfBufGetAllocStats()</a> returns a 128-byte array indexed by length. After a device is operational for some time this indexed array will provide a histogram of buffer allocation that will help with sizing buffer pools. Note that for Bluetooth 4.2 and beyond the max PDU has been increased beyond 128 bytes and therefore may need to be resized accordingly.<br />
<br />
 The WSF buffer pool statistics allow for the “tuning” of buffer pools to optimize memory use on a device. When <a class="el" href="group___w_s_f___b_u_f___a_p_i.html#gaef2252654c1d7a94739adfa318cf7317">WSF_BUF_STATS</a> == <a class="el" href="group___w_s_f___t_y_p_e_s.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> the wsfBufPool_t structure tracks the number of current allocations, the maximum buffer allocations from a specific pool at any given time, and the maximum request length from that pool. By analyzing these statistics against a device’s WSF buffer pool configuration you can re-size and optimize the number of buffers allocated for individual pools.<br />
<br />
 The maxAlloc gives you the maximum buffers allocated from an individual pool while operational. We recommend ensuring that the number of allocated pools is chosen to ensure that this maximum can be supported, with some additional buffers available for more resource intensive use cases. Note that in the case that a buffer pool overflows, buffers will be utilized from the next highest pool size. This occurs when the maxAlloc reaches the number of allocated buffers for that pool, and will affect the number of allocated buffers for larger pools. Because of this we recommend performing size optimizations starting with the smallest buffer pool.<br />
<br />
 The maxReqLen is the maximum length buffer requested from that allocation pool. This can be used (along with <a class="el" href="group___w_s_f___b_u_f___a_p_i.html#gabbcaca59a0d42049fa29ccbae12324ba" title="Diagnostic function to get the buffer allocation statistics. ">WsfBufGetAllocStats()</a>) to optimize the size of buffer pools. For example if a 128 byte buffer pool is configured but the maximum size buffer ever allocated from this pool is 64 bytes than you may consider resizing to the maximum so the additional memory required for the larger buffers are not wasted.</p>
<h1><a class="anchor" id="WSF_QUEUES"></a>
Queue Management</h1>
<p>The WSF queue service is a general purpose queue service that is used throughout the software system.<br />
<br />
 The queue service interface is defined in function <a class="el" href="wsf__queue_8h.html" title="General purpose queue service. ">wsf_queue.h</a>.<br />
<br />
 See <a class="el" href="group___w_s_f___q_u_e_u_e___a_p_i.html">WSF Queue API</a> for more detail.</p>
<h1><a class="anchor" id="WSF_MESSAGES"></a>
Messages Passing</h1>
<p>The WSF message service is used to pass messages to WSF event handlers.<br />
<br />
 The WSF message service is defined in file <a class="el" href="wsf__msg_8h.html" title="Message passing service. ">wsf_msg.h</a>.<br />
<br />
 See <a class="el" href="group___w_s_f___m_s_g___a_p_i.html">WSF Message API</a> for more detail.</p>
<h1><a class="anchor" id="WSF_TIMERS"></a>
Timers</h1>
<p>The WSF timer service is used by WSF event handlers.<br />
<br />
 When a timer expires, the event handler associated with that timer is executed.<br />
<br />
 The WSF timer service is defined in file <a class="el" href="wsf__timer_8h.html" title="Timer service. ">wsf_timer.h</a>.<br />
<br />
 See <a class="el" href="group___w_s_f___t_i_m_e_r___a_p_i.html">WSF Timer API</a> for more detail.</p>
<h1><a class="anchor" id="WSF_EVENTS"></a>
Event Handlers</h1>
<p>WSF event handlers receive WSF events, messages, and timer expirations from other components in the software system. Event handlers are used by the main protocol subsystems of the stack. <br />
<br />
 The event handler interface is defined in file <a class="el" href="wsf__os_8h.html" title="Software foundation OS API. ">wsf_os.h</a>. <br />
<br />
 See <a class="el" href="group___w_s_f___o_s___a_p_i.html">WSF OS API</a> for more detail.</p>
<h1><a class="anchor" id="WSF_CS"></a>
Critical Sections</h1>
<p>WSF provides critical section macros that are used in code which might be executed in interrupt context to protect global data.<br />
<br />
 The critical section interface is defined in file <a class="el" href="wsf__cs_8h.html" title="Critical section macros. ">wsf_cs.h</a>.<br />
<br />
 See <a class="el" href="group___w_s_f___c_s___a_p_i.html">WSF Critical Section API</a> for more detail.</p>
<h1><a class="anchor" id="WSF_SCHEDULING"></a>
Task Schedule Locking</h1>
<p>WSF provides interfaces for locking and unlocking task scheduling. This allows for operation in pre-emptive multi-tasking environments.<br />
<br />
 The task schedule locking interface is defined in file <a class="el" href="wsf__os_8h.html" title="Software foundation OS API. ">wsf_os.h</a>.<br />
<br />
 See <a class="el" href="group___w_s_f___o_s___a_p_i.html">WSF OS API</a> for more detail.</p>
<h1><a class="anchor" id="WSF_ASSERT"></a>
Assert</h1>
<p>WSF defines assert macros that are used for testing and debugging purposes.<br />
<br />
 The assert interface is defined in file <a class="el" href="wsf__assert_8h.html" title="Assert macro. ">wsf_assert.h</a>.<br />
<br />
 See <a class="el" href="group___w_s_f___a_s_s_e_r_t___a_p_i.html">WSF Assert API</a> for more detail.</p>
<h1><a class="anchor" id="WSF_TRACE"></a>
Trace</h1>
<p>WSF defines trace macros that are used throughout the software system for diagnostic purposes. A separate set of trace macros is used for each software subsystem (for example, WSF, HCI, DM, and ATT). This allows trace messages to be compiled in/out for each subsystem. Within each set of subsystem trace macros there are separate macros for different types of trace messages:</p><ul>
<li>INFO: Informational messages.</li>
<li>WARN: Warning messages.</li>
<li>ERR: Error messages.</li>
<li>ALLOC: Memory or other resource is allocated.</li>
<li>FREE: Memory or other resource is freed.</li>
<li>MSG: WSF event handler message is sent.</li>
</ul>
<p>The trace interface is define in file <a class="el" href="wsf__trace_8h.html" title="Trace message interface. ">wsf_trace.h</a>.<br />
<br />
 See <a class="el" href="group___w_s_f___t_r_a_c_e___a_p_i.html">WSF Trace API</a> for more detail.</p>
<h1><a class="anchor" id="WSF_EFS"></a>
Embedded File System</h1>
<p>The Embedded File System (EFS) provides applications with a simple interface for storing data in non-volatile and volatile memory. The Embedded File System (EFS) works in conjunctions with ARM’s proprietary Wireless Data Exchange Profile (WDXS) to provide wireless access to the Embedded File System.<br />
<br />
 The EFS is defined in file <a class="el" href="wsf__efs_8h.html" title="Embedded File System service. ">wsf_efs.h</a>.<br />
<br />
 See <a class="el" href="group___w_s_f___e_f_s___a_p_i.html">WSF Embedded File System API</a> for more detail.</p>
<h2><a class="anchor" id="WSF_EFS_OVERVIEW"></a>
Overview</h2>
<p>The Embedded File System (EFS) provides a simple API for file storage in ExactLE applications. The EFS provides a common interface for storing files in Flash, EEPROM, RAM, and other forms of volatile and non-volatile storage. The EFS is compatible with the ARN’s proprietary Wireless Data Exchange Profile (WDXS) for allowing wireless access to the file system.</p>
<p>The EFS is implemented in two layers: The File Access Layer and The Media Access Layer.</p>
<h2><a class="anchor" id="WSF_EFS_FALAPI"></a>
File Access Layer API</h2>
<p>This section contains the Applications Interface for the File Access Layer. The file Access layer access to files on the file system.<br />
<br />
 The File Access Layer provides the Wireless Data Exchange Profile (WDXS) and BTLE Applications access to the File System. The File Access Layer provides functions for performing the following operations:</p><ul>
<li>Add a file.</li>
<li>Remove a file.</li>
<li>Erase the contents of a file.</li>
<li>Get data from a file. The Get operation is similar to a file read.</li>
<li>Put data into a file. The Put operation is similar to a file write.</li>
<li>Get file attributes.</li>
<li>Set file attributes.</li>
<li>Register media types.</li>
</ul>
<p>The File Access Layer makes calls into the File Media Layer to access the physical storage medium.</p>
<h2><a class="anchor" id="WSF_EFS_FMLAPI"></a>
File Media Layer API</h2>
<p>This section documents the Application Interface for the File Media Layer. The File Media Layer operates a glue layer between the File Access Layer and the drivers that drive the physical storage on the target hardware (Flash, EEPROM, etc.).</p>
<p>The File Media Layer provides an abstraction layer between the File Access Layer and physical storage medium such as RAM, Flash, and EEPROM. Callback functions to perform the following operations on the physical medium are registered with the EFS by the application:</p><ul>
<li>Initialize the medium</li>
<li>Write to the medium</li>
<li>Read from the medium</li>
<li>Erase data in the medium</li>
</ul>
<h1><a class="anchor" id="WSF_UTIL"></a>
Utilities</h1>
<p>WSF provides utility functions and macros for a variety of use cases. This includes Bluetooth device address parsing, memory access and mutation, CRC, string formatting and terminal interfacing.<br />
<br />
 See <a class="el" href="group___w_s_f___u_t_i_l___a_p_i.html">WSF Utility API</a> for more detail. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<ul>
<table width="100%">
    <tr>
        <td align="left" valign="middle">Copyright &copy; 2017-2018 Arm Ltd. All rights reserved.</td>
        <td align="center" valign="middle">Arm Confidential</td>
        <td align="right" valign="middle">Cordio Stack and Cordio Profiles</td>
    </tr>
</table>
</ul>
</div>
</body>
</html>
