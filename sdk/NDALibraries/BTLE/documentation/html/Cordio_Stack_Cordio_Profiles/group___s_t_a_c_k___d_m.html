<!--
  Copyright (c) 2013-2018 Arm Ltd. All Rights Reserved.
  Arm Limited confidential and proprietary.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GAP Device Manager (DM)</title>
<title>Cordio Stack and Cordio Profiles: GAP Device Manager (DM)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="DoxygenStyleSheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo">&#160;<img alt="Logo" src="Arm_Cordio.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">&#160;&#160;&#160;Cordio Stack and Cordio Profiles
   &#160;<span id="projectnumber">r2p3-02rel0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="BLEnav" class="tabs1">
    <ol id="Tabs" class="tablist">
      <script type="text/javascript">
        <!--
        writeComponentTabs.call(this);
        //-->
      </script>
    </ol>
</div>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li class="current"><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___s_t_a_c_k___d_m.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Content</a>  </div>
  <div class="headertitle">
<div class="title">GAP Device Manager (DM)<div class="ingroups"><a class="el" href="group___b_l_e___s_t_a_c_k.html">ble-stack</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Content</h2></td></tr>
<tr class="memitem:group___s_t_a_c_k___d_m___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html">Device Manager API</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<h1><a class="anchor" id="DM_INTRO"></a>
Introduction</h1>
<div class="image">
<img src="diagram_gap.png" alt="diagram_gap.png"/>
<div class="caption">
Figure 1. BLE Stack: GAP</div></div>
<p> The DM subsystem implements device management procedures required by the stack. These procedures are partitioned by procedure category and device role (master or slave). The following procedures are implemented in DM:</p><ul>
<li>Advertising and device visibility: Enable/disable advertising, set advertising parameters and data, set connectability and discoverability.</li>
<li>Scanning and device discovery: Start/stop scanning, set scan parameters, advertising reports, name discovery.</li>
<li>Connection management: Create/accept/remove connections, set/update connection parameters, read RSSI.</li>
<li>Local device management: Initialization and reset, set local parameters, vendor-specific commands, LE GAP attribute management.</li>
<li>Security management: Bonding, storage of security parameters, authentication, encryption, authorization, random address management.</li>
<li>Privacy management: maintenance of resolving list, random address usage and privacy mode.</li>
<li>PHY control</li>
</ul>
<p>DM procedures are implemented in support of the GAP profile when applicable.</p>
<p>The Device Manager controls all GAP behavior which includes the following:</p><ul>
<li><a class="el" href="group___s_t_a_c_k___d_m.html#DM_ADV">DM Advertising</a></li>
<li><a class="el" href="group___s_t_a_c_k___d_m.html#DM_SCAN">DM Scanning and Discovery</a></li>
<li><a class="el" href="group___s_t_a_c_k___d_m.html#DM_CONN">DM Connections</a></li>
<li><a class="el" href="group___s_t_a_c_k___d_m.html#DM_PRIV">DM Privacy</a></li>
</ul>
<p>For full API, see <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html">Device Manager API</a></p>
<h1><a class="anchor" id="DM_ADV"></a>
DM Advertising</h1>
<h2><a class="anchor" id="DM_INTRO_ADV"></a>
Introduction</h2>
<p>The DM interface for advertising and device visibility configures, enables, and disables the advertising procedure. A device advertises when it wants to connect to or be discovered by other devices. Devices may also advertise to simply broadcast data.<br />
<br />
 This interface can only be used when operating as a slave or broadcaster.<br />
<br />
 This implementation handles Legacy and Extended Advertising including Periodic Advertising.</p>
<h1><a class="anchor" id="DM_SCAN"></a>
DM Scanning and Discovery</h1>
<h2><a class="anchor" id="DM_SCAN_INTRO"></a>
Introduction</h2>
<p>The DM scanning and device discovery interface configures, enables, and disables the scanning procedure. A device scans when it wants to discover or connect to other devices. A device may also scan simply to receive broadcast advertisements. <br />
<br />
 This interface can only be used when operating as a master or observer.<br />
<br />
 This implementation handles Legacy and Extended Scanning features including Synchronization on Periodic Advertisements.</p>
<h2><a class="anchor" id="DM_SCAN_BEH"></a>
DM Synchronization Behavior</h2>
<p>Here is the state machine for <a class="el" href="group___d_m___synchronization.html#DM_Synchronization">AE: Create periodic sync behavior</a>.</p>
<h1><a class="anchor" id="DM_CONN"></a>
DM Connections</h1>
<h2><a class="anchor" id="DM_CONN_INTRO"></a>
Introduction</h2>
<p>The DM connection management interface is used to open, accept, configure, and close connections. It is also used to read connection-related information such as the RSSI, channel map, and remote device information.</p>
<h2><a class="anchor" id="DM_CONN_BEH"></a>
DM Connection Behavior</h2>
<p>Here is the state machine for <a class="el" href="group___d_m___connections.html#DM_Connections">Connection behavior</a></p>
<h1><a class="anchor" id="DM_LOCDEVMGT"></a>
DM Local Device Management</h1>
<p>The DM local device management interface is used for initialization and reset, setting local parameters, sending vendor-specific commands, and LE GAP attribute management.</p>
<h1><a class="anchor" id="DM_SEC"></a>
DM Security</h1>
<p>The DM security management interface is used for pairing, authentication, and encryption.</p>
<h1><a class="anchor" id="DM_PRIV"></a>
DM Privacy</h1>
<p>The DM Privacy interface is used by a master or slave device for private address resolution.</p>
<h1><a class="anchor" id="DM_PHY"></a>
DM PHY</h1>
<p>The DM PHY interface is used by a master or slave device to access the transmitter and receiver PHY settings for connections.</p>
<h1><a class="anchor" id="DM_USAGE"></a>
Usage Scenarios</h1>
<h2><a class="anchor" id="DM_USAGE_ADVSCAN"></a>
Advertising and Scanning</h2>
<p>Figure 2 shows a master device performing a scan and a slave device advertising. The slave application first configures the advertising parameters by calling <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga22a9eebae9e1da73402f227b8359482c" title="Set the minimum and maximum advertising intervals. ">DmAdvSetInterval()</a> to set the advertising interval and then <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga979c37eb5d6c091b1f9c86aeb999132a" title="Set the advertising or scan response data to the given data. ">DmAdvSetData()</a> twice to set the advertising data and the scan response data. Then it calls <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga3d7b4f2a38668dcef4cf3a46558cde66" title="Start advertising using the given advertising set and duration. ">DmAdvStart()</a> to start advertising.<br />
<br />
The master application configures the scan interval and then calls <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga2ed97cb0fd0eb72c2e754cfbb33378e9" title="Start scanning on the given PHYs. ">DmScanStart()</a> to begin scanning. When advertisements are received the stack sends <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a9ed5c3ed7ac0f9d683208c0a0f918aea">DM_SCAN_REPORT_IND</a> events to the application. The master application stops scanning by calling <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga51d2df308e7518848e436c12598a3730" title="Stop scanning. ">DmScanStop()</a>. The slave application stops advertising by calling <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#gaf9985a897010ada5098f1c1fc40cbad7" title="Stop advertising for the given advertising set. If the number of sets is set to 0 then all advertisin...">DmAdvStop()</a>.</p>
<div class="image">
<img src="operation_dm_advscan.png" alt="operation_dm_advscan.png"/>
<div class="caption">
Figure 2. Advertising and Scanning</div></div>
 <h2><a class="anchor" id="DM_USAGE_CONN"></a>
Connection Open and Close</h2>
<p>Figure 3 shows connection procedures between two devices. The scenario starts with the slave device advertising and the master device already having the address of the slave. The master application calls <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga408777811a9f80970067595d15d0e1e8" title="Open a connection to a peer device with the given address. ">DmConnOpen()</a> to initiate a connection. A connection is established and a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a653e71469fe3186c5535c787462e9b6d">DM_CONN_OPEN_IND</a> is sent to the application from the stack on each device.<br />
<br />
 Next, the master performs a connection update by calling <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#gaabf7f6103777e1a038f4893f5bff4ade" title="Update the connection parameters of an open connection. ">DmConnUpdate()</a>. When the connection update is complete, a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a0ef6b00fb833483544b7c58d48446bdb">DM_CONN_UPDATE_IND</a> is sent to the application from the stack on each device.<br />
<br />
 Next, the slave closes the connection by calling <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga61da187a676b455f75d233cbef13e39a" title="Close the connection with the give connection identifier. ">DmConnClose()</a>. A <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a6ff6432a6c19601db3916e31d37823a0">DM_CONN_CLOSE_IND</a> event is sent from the stack on each device when the connection is closed.</p>
<div class="image">
<img src="operation_dm_connopenclose.png" alt="operation_dm_connopenclose.png"/>
<div class="caption">
Figure 3. Connection Open and Close</div></div>
 <h2><a class="anchor" id="DM_USAGE_PAIR"></a>
Pairing</h2>
<p>Figure 4 shows a pairing procedure between two devices. A connection is established between the two devices and the master application initiates pairing by calling <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga85a8afe8e325f3828dc86d807472f07a" title="This function is called by a master device to initiate pairing. ">DmSecPairReq()</a>. The slave application receives a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a2dd18cb7d312d127fe356d45b1d04204">DM_SEC_PAIR_IND</a> and calls <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga398ae0eb48fef5924446da9bcb2becf1" title="This function is called by a slave device to proceed with pairing after a DM_SEC_PAIR_IND event is re...">DmSecPairRsp()</a> to proceed with pairing. In this example, a PIN is used and a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a3066dccc3da32807cc3945cbc7fb55b0">DM_SEC_AUTH_REQ_IND</a> is sent to the application on each device to request a PIN. Each application responds with the PIN by calling <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga27f1577cca70c7814deec120493b7684" title="This function is called in response to a DM_SEC_AUTH_REQ_IND event to provide PIN or OOB data during ...">DmSecAuthRsp()</a>.<br />
<br />
 In the next phase of pairing, the connection is encrypted and a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7acf4c1159b08b3ce4f01447659ec6ea82">DM_SEC_ENCRYPT_IND</a> event is sent to the application on each device. Then key exchange begins. According to the Bluetooth specification, the slave device always distributes keys first. In this example, the slave distributes two keys and the master device distributes one. The slave sends its key data to the master. Note that when the slave sends its LTK, the slave application receives a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a372ddee471a1908d3c5f2562a484d5dc">DM_SEC_KEY_IND</a> containing its own LTK. Then the master sends its key data to the slave. When the key exchange is completed successfully, a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a7f78a6ff60779449d7c4073867621a27">DM_SEC_PAIR_CMPL_IND</a> event is sent to the application on each device.</p>
<div class="image">
<img src="operation_dm_pair.png" alt="operation_dm_pair.png"/>
<div class="caption">
Figure 4. Pairing</div></div>
 <h2><a class="anchor" id="DM_USAGE_ENCRYPT"></a>
Encryption</h2>
<p>Figure 5 shows an encryption procedure. In this example the slave device requests security by calling <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#gab75a6fc65296a22347e50bbb2dafdb52" title="This function is called by a slave device to request that the master initiates pairing or link encryp...">DmSecSlaveReq()</a> to sends a slave security request message to the master. The stack on the master sends a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a963129811dbb1f4100f967e848da3838">DM_SEC_SLAVE_REQ_IND</a> to the application. On receiving the event the master application determines that this is a bonded device and its LTK is available, so it calls <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#gadf181ff1426c51752011c3dcc5bd3087" title="This function is called by a master device to initiate link encryption. ">DmSecEncryptReq()</a> to enable encryption.<br />
<br />
 After the encryption procedure is initiated the slave application receives a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a8984927e013570ec97cfbd23c32e658b">DM_SEC_LTK_REQ_IND</a>, requesting the LTK used with this master device. The application finds the key and calls <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga44cb38ccef8930a9264ea866adef6f86" title="This function is called by a slave in response to a DM_SEC_LTK_REQ_IND event to provide the long term...">DmSecLtkRsp()</a>. The encryption procedure completes and a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7acf4c1159b08b3ce4f01447659ec6ea82">DM_SEC_ENCRYPT_IND</a> event is sent to the application on each device.</p>
<div class="image">
<img src="operation_dm_encrypt.png" alt="operation_dm_encrypt.png"/>
<div class="caption">
Figure 5. Encryption</div></div>
 <h2><a class="anchor" id="DM_USAGE_PRIVACY"></a>
Privacy</h2>
<p>Figure 6 shows a master device performing a scan and a slave device advertising with a private resolvable address. Before a master device can resolve a slave’s address, the devices must have paired and the master must have received the slave’s IRK during pairing.<br />
<br />
 The slave application first enables use of a private resolvable address by calling <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga1339a47fd4f46bf2f228ee38c0313511" title="Start using a private resolvable address. ">DmDevPrivStart()</a>. If this is the first time since device reset that <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga1339a47fd4f46bf2f228ee38c0313511" title="Start using a private resolvable address. ">DmDevPrivStart()</a> has been called, the application must wait for a <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a684e8353891c369fc71c88da0f37d222">DM_ADV_NEW_ADDR_IND</a> before it starts advertising. Then it calls <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga3d7b4f2a38668dcef4cf3a46558cde66" title="Start advertising using the given advertising set and duration. ">DmAdvStart()</a> to start advertising.<br />
<br />
 The master application calls <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga2ed97cb0fd0eb72c2e754cfbb33378e9" title="Start scanning on the given PHYs. ">DmScanStart()</a> to begin scanning. When advertisements are received the stack sends <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a9ed5c3ed7ac0f9d683208c0a0f918aea">DM_SCAN_REPORT_IND</a> events to the application. The master application calls <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga14b43fc8b502b2e1d0503f391d3ff8bf" title="Resolve a private resolvable address. When complete the client&#39;s callback function is called with a D...">DmPrivResolveAddr()</a> with the address and address type from the scan report to resolve the address with the IRK it had received previously. After the slave application stops advertising, it can call <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga1e9fa1ad3491354945274d74f04df891" title="Stop using a private resolvable address. ">DmDevPrivStop()</a> to stop using a private resolvable address.</p>
<div class="image">
<img src="operation_dm_privacy.png" alt="operation_dm_privacy.png"/>
<div class="caption">
Figure 6. Privacy</div></div>
 <h2><a class="anchor" id="DM_USAGE_ECC"></a>
ECC Key Generation</h2>
<p>An ECC Key must be stored in the Device Manager before use in LE Secure Connections pairing. The Device Manager can generate an ECC, Elliptic Curve Cryptography, key, or the application can store an ECC Key in Non-Volatile storage. An ECC key cannot be generated until after the Device Manager reset is complete.<br />
<br />
 To generate an ECC Key, call the <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#gad229bc384cef6182b23611fd157054ea" title="This function generates an ECC key for use with LESC security. ">DmSecGenerateEccKeyReq()</a> function after receiving the <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7acd225db5c72bcfb735bbe206e1c4107a">DM_RESET_CMPL_IND</a> event. The <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a1ac5afc666743e1bc73258db0fb79407">DM_SEC_ECC_KEY_IND</a> event will be called after the ECC Key generation is complete. The ECC Key can then be stored into the DM using the <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga0740d8a2a1c649f74d87aeb2362f4b1e" title="This function sets the ECC key for use with LESC security. ">DmSecSetEccKey()</a> function.<br />
<br />
 Note: For some applications, it may be desirable to skip ECC Key Generation and store an ECC key in Non Volatile storage. In these situations, the ECC key can be written to the Device Manager with <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga0740d8a2a1c649f74d87aeb2362f4b1e" title="This function sets the ECC key for use with LESC security. ">DmSecSetEccKey()</a> any time after the DM is reset, and before pairing begins.<br />
<br />
 Note: The Device Manager makes use of the Security service to generate and validate ECC keys. The Security service's ECC subsystem may need to be ported to an application’s target hardware or software framework for LE Secure Connections to operate properly.<br />
<br />
 The following figure shows the ECC Key generation scenario:</p>
<div class="image">
<img src="operation_dm_ecc.png" alt="operation_dm_ecc.png"/>
<div class="caption">
Figure 7. ECC Key Generation</div></div>
 <h2><a class="anchor" id="DM_USAGE_OOB"></a>
Out of Band Confirm Calculation</h2>
<p>When using Out-of-Band (OOB) LE Secure Connections pairing, devices must generate random and confirm values. Furthermore, the devices must exchange random and confirm values through an out-of-band mechanism. At which point, the local and peer random and confirm values must be stored in the Device Manager before OOB pairing starts .<br />
<br />
 The OOB confirm calculation can be performed with <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#gaa2adf4a816a11d81e37a2a8fd50ab688" title="This function calculates the local random and confirm values used in LESC OOB pairing. The operation&#39;s result is posted as a DM_SEC_CALC_OOB_IND event to the application&#39;s DM callback handler. The local rand and confirm values are exchanged with the peer via out-of-band (OOB) methods and passed into the DmSecSetOob after DM_CONN_OPEN_IND. ">DmSecCalcOobReq()</a>, and requires an ECC, Elliptic Curve Cryptography, key. Therefore, on receipt of the ECC key indication event, <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a1ac5afc666743e1bc73258db0fb79407">DM_SEC_ECC_KEY_IND</a>, an application may call the <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#gaa2adf4a816a11d81e37a2a8fd50ab688" title="This function calculates the local random and confirm values used in LESC OOB pairing. The operation&#39;s result is posted as a DM_SEC_CALC_OOB_IND event to the application&#39;s DM callback handler. The local rand and confirm values are exchanged with the peer via out-of-band (OOB) methods and passed into the DmSecSetOob after DM_CONN_OPEN_IND. ">DmSecCalcOobReq()</a> function to calculate an OOB confirm value. The result of the confirm calculation is returned via the <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a98bde9b6569f0c5062360a45ccc44df4">DM_SEC_CALC_OOB_IND</a> event.<br />
<br />
 After an application exchanges random and confirm values via an out-of-band mechanism with a peer, the application must store the local random and confirm values in the device manager. This is performed with the <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ga5e5aac9f6c481b463d80ad1f1c13cc6d" title="This function configures the DM to use OOB pairing for the given connection. The pRand and pConfirm c...">DmSecSetOob()</a> function on receipt of the <a class="el" href="group___s_t_a_c_k___d_m___a_p_i.html#ggadf764cbdea00d65edcd07bb9953ad2b7a3066dccc3da32807cc3945cbc7fb55b0">DM_SEC_AUTH_REQ_IND</a> event. The following figure shows the OOB confirm calculation scenario:</p>
<div class="image">
<img src="operation_dm_oob.png" alt="operation_dm_oob.png"/>
<div class="caption">
Figure 8. OOB Confirm Generation</div></div>
<p><br />
</p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<ul>
<table width="100%">
    <tr>
        <td align="left" valign="middle">Copyright &copy; 2017-2018 Arm Ltd. All rights reserved.</td>
        <td align="center" valign="middle">Arm Confidential</td>
        <td align="right" valign="middle">Cordio Stack and Cordio Profiles</td>
    </tr>
</table>
</ul>
</div>
</body>
</html>
