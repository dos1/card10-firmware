<!--
  Copyright (c) 2013-2018 Arm Ltd. All Rights Reserved.
  Arm Limited confidential and proprietary.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Host Controller Interface (HCI)</title>
<title>Cordio Stack and Cordio Profiles: Host Controller Interface (HCI)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="DoxygenStyleSheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo">&#160;<img alt="Logo" src="Arm_Cordio.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">&#160;&#160;&#160;Cordio Stack and Cordio Profiles
   &#160;<span id="projectnumber">r2p3-02rel0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="BLEnav" class="tabs1">
    <ol id="Tabs" class="tablist">
      <script type="text/javascript">
        <!--
        writeComponentTabs.call(this);
        //-->
      </script>
    </ol>
</div>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li class="current"><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___s_t_a_c_k___h_c_i.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Content</a>  </div>
  <div class="headertitle">
<div class="title">Host Controller Interface (HCI)<div class="ingroups"><a class="el" href="group___b_l_e___s_t_a_c_k.html">ble-stack</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Content</h2></td></tr>
<tr class="memitem:group___s_t_a_c_k___h_c_i___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_a_c_k___h_c_i___a_p_i.html">Generic HCI Definitions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___s_t_a_c_k___h_c_i___i_n_i_t___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_a_c_k___h_c_i___i_n_i_t___a_p_i.html">HCI Initialization, Regisration, Reset</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___s_t_a_c_k___h_c_i___c_m_d___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html">HCI Command Interface</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___s_t_a_c_k___h_c_i___o_p_t___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_a_c_k___h_c_i___o_p_t___a_p_i.html">HCI Optimization Interface</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___s_t_a_c_k___h_c_i___e_v_t___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_a_c_k___h_c_i___e_v_t___a_p_i.html">HCI Event Interface</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___s_t_a_c_k___h_c_i___a_c_l___a_p_i"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_a_c_k___h_c_i___a_c_l___a_p_i.html">HCI ACL Data Interface</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<h1><a class="anchor" id="HCI_INTRO"></a>
Introduction</h1>
<div class="image">
<img src="diagram_hci.png" alt="diagram_hci.png"/>
<div class="caption">
Figure 1. BLE Stack: HCI</div></div>
<p> The HCI subsystem implements the host-controller interface specification. This specification defines commands, events, and data packets sent between a Bluetooth LE protocol stack on a host and a link layer on a controller.<br />
<br />
 The HCI API is optimized to be a thin interface layer for a single-chip system. It is configurable for either a single-chip system or traditional system with wired HCI.<br />
<br />
 This configurability is accomplished through a layered implementation. A routing layer can be configured for either a single-chip system or wired HCI. A transport and driver layer below the routing layer can be configured for different wired transports such as UART or USB.<br />
<br />
 HCI also contains certain configurable initialization features which are executed as part of the stack initialization.<br />
<br />
 For full API, see <a class="el" href="group___s_t_a_c_k___h_c_i___a_p_i.html">Generic HCI Definitions</a></p>
<h2><a class="anchor" id="HCI_OVERVIEW"></a>
Overview</h2>
<p>This page describes the API for the <em>Host</em> <em>Controller</em> <em>Interface</em> (HCI) layer of ARMâ€™s Bluetooth LE protocol stack.<br />
<br />
 This API is used by the Bluetooth LE stack to communicate with a Bluetooth LE controller or link layer. Traditionally, HCI is a message passing interface consisting of command and event messages defined by the Bluetooth specification.<br />
<br />
 The Bluetooth specification defines the HCI messages and parameters. Rather than repeat that information here, this document describes how details of the API implementation differ from the <em>Bluetooth</em> <em>Core</em> <em>Specification</em>.</p>
<h2><a class="anchor" id="HCI_TOPO"></a>
HCI Topologies</h2>
<p>The different HCI topologies for a single-chip system and a traditional stack with HCI are shown below in Figure 2.</p>
<div class="image">
<img src="diagram_hci_topo.png" alt="diagram_hci_topo.png"/>
<div class="caption">
Figure 2. HCI Topologies</div></div>
<p> In a single-chip system the HCI layer mainly serves two purposes. First, it implements a message passing interface between the stack and the link layer. Second, it translates the HCI API used by the stack (as defined in this document) to the API used by the link layer.<br />
<br />
 In a traditional stack with HCI, the HCI layer serves several purposes. It implements a message passing interface between the stack and the wired transport. It builds and parses byte-oriented messages for transmission on the wired transport. It also implements a transport-specific driver to send and receive data on the wired transport.<br />
<br />
 There are also differences in the data flow. In a traditional stack, the HCI layer also implements handling of transmit path data flow and processing of HCI Number of Completed Packets events. In a single-chip system the HCI layer adapts the data path interface required by the stack to the link layerâ€™s data path.</p>
<h2><a class="anchor" id="HCI_DATA"></a>
Basic Data Types</h2>
<p>The Bluetooth HCI specification defines parameters in terms of octets. These octets map to integer data types as shown below:</p>
<table class="doxtable">
<tr>
<th align="left">Octets </th><th align="left">Stack Data Types  </th></tr>
<tr>
<td align="left">1 Octet </td><td align="left">int8_t or uint8_t </td></tr>
<tr>
<td align="left">2 Octets </td><td align="left">uint16_t </td></tr>
<tr>
<td align="left">3 or 4 Octets </td><td align="left">uint32_t </td></tr>
<tr>
<td align="left">&gt; 4 Octets </td><td align="left">uint8_t array or other data structure </td></tr>
</table>
<p>The following type is used for the Bluetooth device address.</p>
<table class="doxtable">
<tr>
<th align="left">Type </th><th align="left">Name  </th></tr>
<tr>
<td align="left">uint8_t </td><td align="left">bdAddr_t[6] </td></tr>
</table>
<h1><a class="anchor" id="HCI_INIT"></a>
Initialization, Registration, and Reset</h1>
<p>A Reset of the HCI reset sequence is initiated by a call to <a class="el" href="group___s_t_a_c_k___h_c_i___i_n_i_t___a_p_i.html#ga9d39d641feb37f7d21a0c709906e5b55" title="Initiate an HCI reset sequence. ">HciResetSequence()</a>. This function initiates an HCI reset sequence, which sends an HCI Reset command followed by several other HCI commands. This HCI command sequence is configurable for each platform. When the reset sequence is complete, a Reset Sequence Complete event is sent via the event callback.<br />
<br />
 Syntax:<br />
<br />
 void <a class="el" href="group___s_t_a_c_k___h_c_i___i_n_i_t___a_p_i.html#ga9d39d641feb37f7d21a0c709906e5b55" title="Initiate an HCI reset sequence. ">HciResetSequence(void)</a><br />
<br />
 A typical reset sequence is as follows:</p><ol type="1">
<li>Reset Command</li>
<li>Set Event Mask Command</li>
<li>LE Set Event Mask Command</li>
<li>Set Event Mask Page 2 Command</li>
<li>Read BD_ADDR Command</li>
<li>LE Read Buffer Size Command</li>
<li>Read Buffer Size Command</li>
<li>LE Read Supported States Command</li>
<li>LE Read White List Size Command</li>
<li>LE Read Local Supported Feature Command</li>
<li>LE Read Resolving List Size Command</li>
<li>LE Read Maximum Data Length Command</li>
<li>LE Write Suggested Default Data Length Command</li>
<li>LE Random Command</li>
</ol>
<p>See <a class="el" href="group___s_t_a_c_k___h_c_i___i_n_i_t___a_p_i.html">HCI Initialization, Regisration, Reset</a> for API.</p>
<h1><a class="anchor" id="HCI_OPT"></a>
Optimization Interface</h1>
<p>This is an optimized interface for certain HCI commands that simply read a value. The stack uses these functions rather than their corresponding functions in the command interface.<br />
<br />
 These functions can only be called after the reset sequence has been completed.<br />
<br />
 See <a class="el" href="group___s_t_a_c_k___h_c_i___o_p_t___a_p_i.html">HCI Optimization Interface</a> for API.</p>
<h1><a class="anchor" id="HCI_CMD"></a>
Command Interface</h1>
<p>This interface contains functions that map directly to HCI commands. The operation of the HCI commands and their parameters are not described in this document. See the <em>Bluetooth</em> <em>Core</em> <em>Specification</em> document.<br />
<br />
 The HCI implementation for a particular platform does not need to implement all functions in the command interface. For example, a single-chip system that implements the functions in the optimization interface, such as <a class="el" href="group___s_t_a_c_k___h_c_i___o_p_t___a_p_i.html#gae605596932989d4c5744e5001cf5da20" title="Return a pointer to the BD address of this device. ">HciGetBdAddr()</a>, might not need to implement the corresponding functions in the command interface (for example <a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga1d720ce85095a31c6fac72e798ce736d" title="HCI read BD address command. ">HciReadBdAddrCmd()</a>).<br />
<br />
 See <a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html">HCI Command Interface</a> for API.</p>
<h2><a class="anchor" id="HCI_OPT_CMDS"></a>
Commands</h2>
<p>The command interface functions are shown in the table below. See the <em>Bluetooth</em> <em>Core</em> <em>Specification</em> document for a description of the parameters and operation of these functions. Functions shown as not implemented are not used by ARMâ€™s Bluetooth LE stack.</p>
<table class="doxtable">
<tr>
<th align="left">HCI Command </th><th align="left">Function  </th></tr>
<tr>
<td align="left">Disconnect </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gac095d8c13a6292aecbeaafecec841b7d">HciDisconnectCmd</a> </td></tr>
<tr>
<td align="left">Read Remote Version Information </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga08b3d62537b907986a4b21265b6c4034">HciReadRemoteVerInfoCmd</a> </td></tr>
<tr>
<td align="left">Set Event Mask </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga4f0b5f60861eead330962c1c0452e8d9">HciSetEventMaskCmd</a> </td></tr>
<tr>
<td align="left">Reset </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gadca06d7a62fef2a56c590f9db40ca1e4">HciResetCmd</a> </td></tr>
<tr>
<td align="left">Read Transmit Power Level </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga137ce1768cc543f917b23000572bb975">HciReadTxPwrLvlCmd</a> </td></tr>
<tr>
<td align="left">Set Controller To Host Flow Control </td><td align="left">Not Supported </td></tr>
<tr>
<td align="left">Host Buffer Size </td><td align="left">Not Supported </td></tr>
<tr>
<td align="left">Host Number of Completed Packets </td><td align="left">Not Supported </td></tr>
<tr>
<td align="left">Set Event Mask Page 2 </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gacc1ba7f90d8b208d93f19656748a15e6">HciSetEventMaskPage2Cmd</a> </td></tr>
<tr>
<td align="left">Read Authenticated Payload Timeout </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga100a91e9c3cee6484a05d598f6c22442">HciReadAuthPayloadTimeout</a> </td></tr>
<tr>
<td align="left">Write Authenticated Payload Timeout </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga2cee73e1a29b3aec3d7ec4afdffccb2a">HciWriteAuthPayloadTimeout</a> </td></tr>
<tr>
<td align="left">Read Local Version Information </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga6554d59946750877218798b795bdc77d">HciReadLocalVerInfoCmd</a> </td></tr>
<tr>
<td align="left">Read Local Supported Features </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga9b72eb74eb20dd90a04b6846bfa5a532">HciReadLocalSupFeatCmd</a> </td></tr>
<tr>
<td align="left">Read Buffer Size </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gab0592a240905e52dd1317a9863f59d7e">HciReadBufSizeCmd</a> </td></tr>
<tr>
<td align="left">Read BD_ADDR </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga1d720ce85095a31c6fac72e798ce736d">HciReadBdAddrCmd</a> </td></tr>
<tr>
<td align="left">Read RSSI </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga931135ff528c7c33a52bd98d4c1718d8">HciReadRssiCmd</a> </td></tr>
<tr>
<td align="left">LE Set Event Mask </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga3c19b63ad8426816e9629b48bcea01a6">HciLeSetEventMaskCmd</a> </td></tr>
<tr>
<td align="left">LE Read Buffer Size </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga57550ba765f7dbea058d0aeb5aa813c6">HciLeReadBufSizeCmd</a> </td></tr>
<tr>
<td align="left">LE Read Local Supported Features </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gae480fe487177e94a542f2d7afdf68840">HciLeReadLocalSupFeatCmd</a> </td></tr>
<tr>
<td align="left">LE Set Random Address </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gadbf0e819376bb60df0dd8a6d38b70932">HciLeSetRandAddrCmd</a> </td></tr>
<tr>
<td align="left">LE Set Advertising Parameters </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaa098fd9affdf7a9a03d375ae78a30c77">HciLeSetAdvParamCmd</a> </td></tr>
<tr>
<td align="left">LE Read Advertising Channel TX Power </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaebea764d7da80fb98e835fe26f48a3da">HciLeReadAdvTXPowerCmd</a> </td></tr>
<tr>
<td align="left">LE Set Advertising Data </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga1d094bbe4a0406b507d46dbded03bd2f">HciLeSetAdvDataCmd</a> </td></tr>
<tr>
<td align="left">LE Set Scan Response Data </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gacf641ecc20d2bb1a55859079e7d63e64">HciLeSetScanRespDataCmd</a> </td></tr>
<tr>
<td align="left">LE Set Advertise Enable </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gadf38390431c8ded08b2671bf435453d8">HciLeSetAdvEnableCmd</a> </td></tr>
<tr>
<td align="left">LE Set Scan Parameters </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga6a64229166bf5b03dcdc93c0a4dec661">HciLeSetScanParamCmd</a> </td></tr>
<tr>
<td align="left">LE Set Scan Enable </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga51b38ef546408f84ef666130de638a84">HciLeSetScanEnableCmd</a> </td></tr>
<tr>
<td align="left">LE Create Connection </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gab82b0162188709f8e1402dd599d72713">HciLeCreateConnCmd</a> </td></tr>
<tr>
<td align="left">LE Create Connection Cancel </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga0bd1604eb06b9a39ac77b93647f111f3">HciLeCreateConnCancelCmd</a> </td></tr>
<tr>
<td align="left">LE Read White List Size </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gad1b765d806e071124c40e55f58d95747">HciLeReadWhiteListSizeCmd</a> </td></tr>
<tr>
<td align="left">LE Clear White List </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga8ecaaa3c9a0c4e92e4c786edfb9cf9ca">HciLeClearWhiteListCmd</a> </td></tr>
<tr>
<td align="left">LE Add Device to White List </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaf32366073d312583db50dcbe0525c814">HciLeAddDevWhiteListCmd</a> </td></tr>
<tr>
<td align="left">LE Remove Device from White List </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga217de6048519234e186619970b2b1ba8">HciLeRemoveDevWhiteListCmd</a> </td></tr>
<tr>
<td align="left">LE Connection Update </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaf6fe76fff10960686abc5113e6276418">HciLeConnUpdateCmd</a> </td></tr>
<tr>
<td align="left">LE Set Host Channel Classification </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gac6365e0cf4090b6365c163eee5720c39">HciLeSetHostChanClassCmd</a> </td></tr>
<tr>
<td align="left">LE Read Channel Map </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga55ea80b7be65581a43946f8225d9d6c4">HciLeReadChanMapCmd</a> </td></tr>
<tr>
<td align="left">LE Read Remote Used Features </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga6cec450f6b6900ee2d6d2f729b4d973c">HciLeReadRemoteFeatCmd</a> </td></tr>
<tr>
<td align="left">LE Encrypt </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga116d6f901671981e8cc98d144f9b01d7">HciLeEncryptCmd</a> </td></tr>
<tr>
<td align="left">LE Rand </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gadca7925b81a4fed3cdd8f6c8757522fa">HciLeRandCmd</a> </td></tr>
<tr>
<td align="left">LE Start Encryption </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga9f1c342c94eb44348b169fa99cbf4887">HciLeStartEncryptionCmd</a> </td></tr>
<tr>
<td align="left">LE Long Term Key Request Negative Reply </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga98f72c06f76c479a85d20dd12f5a3341">HciLeLtkReqNegReplCmd</a> </td></tr>
<tr>
<td align="left">LE Long Term Key Requested Reply </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gad72ffebb6010a7849d6f221bc34ed7cb">HciLeLtkReqReplCmd</a> </td></tr>
<tr>
<td align="left">LE Read Supported States </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga26a2bbc61faf514116e802d8cd4a77b2">HciLeReadSupStatesCmd</a> </td></tr>
<tr>
<td align="left">LE Receiver Test </td><td align="left">Not Supported </td></tr>
<tr>
<td align="left">LE Transmitter Test </td><td align="left">Not Supported </td></tr>
<tr>
<td align="left">LE Test End </td><td align="left">Not Supported </td></tr>
<tr>
<td align="left">LE Remote Connection Parameter Request Reply </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga41886b3db0fdc7db9296a1b264aded07">HciLeRemoteConnParamReqReply</a> </td></tr>
<tr>
<td align="left">LE Remote Connection Parameter Request Negative Reply </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga82938d6140f506171985562c5232e60e">HciLeRemoteConnParamReqNegReply</a> </td></tr>
<tr>
<td align="left">LE Set Data Length </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaaee1abe5cc9ecec50398c095fd9edde0">HciLeSetDataLen</a> </td></tr>
<tr>
<td align="left">LE Read Suggested Default Data Length </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga44e561d9716c69f1e7a62fdd1dddf004">HciLeReadDefDataLen</a> </td></tr>
<tr>
<td align="left">LE Write Suggested Default Data Length </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga180f5fa5c35992ee5ab25e12bd0ca336">HciLeWriteDefDataLen</a> </td></tr>
<tr>
<td align="left">LE Read Local P-256 Public Key </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga8f0ca7055daec9f2e3f7d3fec728e654">HciLeReadLocalP256PubKey</a> </td></tr>
<tr>
<td align="left">LE Generate DH Key </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga2f01387d5928b0f487ce4f18167eda24">HciLeGenerateDHKey</a> </td></tr>
<tr>
<td align="left">LE Add Device to Resolving List </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga316fa12182a491f9a8fd1cec97f8f5ee">HciLeAddDeviceToResolvingListCmd</a> </td></tr>
<tr>
<td align="left">LE Remove Device from Resolving List </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga908d06a95483d105dfd0ab28bfd6b79d">HciLeRemoveDeviceFromResolvingList</a> </td></tr>
<tr>
<td align="left">LE Clear Resolving List </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga7d1855c4a301932cbfe79ced8b3c162d">HciLeClearResolvingList</a> </td></tr>
<tr>
<td align="left">LE Read Resolving List Size </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga1fc957949af870c7e656047517226c26">HciLeReadResolvingListSize</a> </td></tr>
<tr>
<td align="left">LE Read Peer Resolvable Address </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gafb391e7e470d2f648cf2b1fb4f4ce71d">HciLeReadPeerResolvableAddr</a> </td></tr>
<tr>
<td align="left">LE Read Local Resolvable Address </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaa4c8c123f2d6acfdc285b494c5578189">HciLeReadLocalResolvableAddr</a> </td></tr>
<tr>
<td align="left">LE Set Address Resolution Enable </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gac33b854935f0c2ea3c24048985ee6b90">HciLeSetAddrResolutionEnable</a> </td></tr>
<tr>
<td align="left">LE Set Resolvable Private Address Timeout </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaa12bec51636c78ac6c9cff877b80db0e">HciLeSetResolvablePrivateAddrTimeout</a> </td></tr>
<tr>
<td align="left">LE Read Maximum Data Length </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gadd388a1baf682808f8ad1a1fc31d2be2">HciLeReadMaxDataLen</a> </td></tr>
<tr>
<td align="left">LE Read PHY </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga104520f614182c5202337937c9a7b78b">HciLeReadPhyCmd</a> </td></tr>
<tr>
<td align="left">LE Set Default PHY </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gad00d12b52372a37502f58280e7c0f04c">HciLeSetDefaultPhyCmd</a> </td></tr>
<tr>
<td align="left">LE Set PHY </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga1c993d3e0b2efcb23f4cc71a2b78a130">HciLeSetPhyCmd</a> </td></tr>
<tr>
<td align="left">LE Enhanced Receiver Test </td><td align="left">Not Supported </td></tr>
<tr>
<td align="left">LE Enhanced Transmitter Test </td><td align="left">Not Supported </td></tr>
<tr>
<td align="left">LE Set Advertising Set Random Address </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga91b925543bc059400b2ef2e440e3eef9">HciLeSetAdvSetRandAddrCmd</a> </td></tr>
<tr>
<td align="left">LE Set Extended Advertising Parameters </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gab7561d5920832da9691990fcff5548d2">HciLeSetExtAdvParamCmd</a> </td></tr>
<tr>
<td align="left">LE Set Extended Advertising Data </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga9102c8ad6af5054ec9292044e839d707">HciLeSetExtAdvDataCmd</a> </td></tr>
<tr>
<td align="left">LE Set Extended Scan Response Data </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga6fe97cc904faabb8a6550406fb614105">HciLeSetExtScanRespDataCmd</a> </td></tr>
<tr>
<td align="left">LE Set Extended Advertising Enable </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga8cf856aa7fddb8cc1d8fdd5109b94520">HciLeSetExtAdvEnableCmd</a> </td></tr>
<tr>
<td align="left">LE Read Maximum Advertising Data Length </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga3ab76e15098a0299cb7520201fd42048">HciLeReadMaxAdvDataLen</a> </td></tr>
<tr>
<td align="left">LE Read Number of Supported Advertising Sets </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga0946598f953a0a77bc84fb9178503488">HciLeReadNumSupAdvSets</a> </td></tr>
<tr>
<td align="left">LE Set Periodic Advertising Parameters </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gabc18399ce32d16774866c0663a4211a6">HciLeSetPerAdvParamCmd</a> </td></tr>
<tr>
<td align="left">LE Set Periodic Advertising Data </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga65e634e382017ee8988742d6ea72f744">HciLeSetPerAdvDataCmd</a> </td></tr>
<tr>
<td align="left">LE Set Periodic Advertising Enabled </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga46664025d36b7added71ec97a409eb4c">HciLeSetPerAdvEnableCmd</a> </td></tr>
<tr>
<td align="left">LE Remove Advertising Set </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga13469dbc42abd93ef2b6763fb1ad7223">HciLeRemoveAdvSet</a> </td></tr>
<tr>
<td align="left">LE Clear Advertising Sets </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga33732120c293794a18cb190a6d20d61a">HciLeClearAdvSets</a> </td></tr>
<tr>
<td align="left">LE Set Extended Scanning Parameters </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gabd600b5a65641da975155821b652e21a">HciLeSetExtScanParamCmd</a> </td></tr>
<tr>
<td align="left">LE Set Extended Scan Enable </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gad736e108a944fffaf97523d1e21c6800">HciLeExtScanEnableCmd</a> </td></tr>
<tr>
<td align="left">LE Extended Create Connection </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga5a5a0ea1aa9364173433b2a22a8adc2a">HciLeExtCreateConnCmd</a> </td></tr>
<tr>
<td align="left">LE Periodic Advertising Create Sync </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga57704d6cf89f9a684c68da8d33f03c97">HciLePerAdvCreateSyncCmd</a> </td></tr>
<tr>
<td align="left">LE Periodic Advertising Create Sync Cancel </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaf88509a4208c3ad9ac93bb0d686d7f1f">HciLePerAdvCreateSyncCancelCmd</a> </td></tr>
<tr>
<td align="left">LE Periodic Advertising Terminate Sync </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gadb3f673cc857ff9507056af807ed4961">HciLeAddDeviceToPerAdvListCmd</a> </td></tr>
<tr>
<td align="left">LE Add Device to Periodic Advertiser List </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gadb3f673cc857ff9507056af807ed4961">HciLeAddDeviceToPerAdvListCmd</a> </td></tr>
<tr>
<td align="left">LE Remove Device from Periodic Advertiser List </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gab75ae054bb1abd6fa057a3f94adf11dd">HciLeRemoveDeviceFromPerAdvListCmd</a> </td></tr>
<tr>
<td align="left">LE Clear Periodic Advertiser List </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gad766e93b2bd9c5ceb0832e03aac18f82">HciLeClearPerAdvListCmd</a> </td></tr>
<tr>
<td align="left">LE Read Periodic Advertiser List Size </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga629ac1402a22020e1f9ae83849b3ef1b">HciLeReadPerAdvListSizeCmd</a> </td></tr>
<tr>
<td align="left">LE Read Transmit Power </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga22c54dbd652b109d1d9efbd08c8a8510">HciLeReadTxPower</a> </td></tr>
<tr>
<td align="left">LE Read RF Path Compensation </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#ga5e7e1e20133ed3f952f1a8f2bd168d9d">HciLeReadRfPathComp</a> </td></tr>
<tr>
<td align="left">LE Write RF Path Compensation </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaee72dc2c87d5e04064666221a9e89ac9">HciLeWriteRfPathComp</a> </td></tr>
<tr>
<td align="left">LE Set Privacy Mode </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaa599ccf6914202605906d65a8a7b48ef">HciLeSetPrivacyModeCmd</a> </td></tr>
<tr>
<td align="left">Vendor Specific </td><td align="left"><a class="el" href="group___s_t_a_c_k___h_c_i___c_m_d___a_p_i.html#gaf720b09359444f05eb0352a1c84758cc">HciVendorSpecificCmd</a> </td></tr>
</table>
<h1><a class="anchor" id="HCI_EVT"></a>
Event Interface</h1>
<p>The event interface defines event data structures which are passed from HCI to the stack. HCI events and their parameters defined in the <em>Bluetooth</em> <em>Core</em> <em>Specification</em> document are mapped to internal event values and data structures that can be processed efficiently by the stack.</p>
<p>See <a class="el" href="group___s_t_a_c_k___h_c_i___e_v_t___a_p_i.html">HCI Event Interface</a> for event interface details.</p>
<h1><a class="anchor" id="HCI_ACL"></a>
ACL Data Interface</h1>
<p>The ACL data interface contains the following functions:</p><ul>
<li>An API function for sending data to HCI</li>
<li>A callback function for receiving data from HCI, and a callback function for managing flow control.</li>
</ul>
<p>ACL data is sent using <a class="el" href="group___s_t_a_c_k___h_c_i___a_c_l___a_p_i.html#gaeba76cd2310f3de5f92aef2f55e38d38">HciSendAclData()</a>. The ACL packet is formatted as defined in the <em>Bluetooth</em> <em>Core</em> <em>Specification</em> document:</p><ul>
<li>The first two bytes of the buffer contain the handle for the ACL connection.</li>
<li>The next two bytes of the buffer contain the length.</li>
</ul>
<p>The caller of this function is responsible for allocating the WSF buffer pointed to by pAclData. HCI is responsible for deallocating the buffer.<br />
<br />
 ACL data is received by the stack from HCI through the <a class="el" href="group___s_t_a_c_k___h_c_i___a_c_l___a_p_i.html#ga4f2baf6a4dac63799a65aa28ac721a80">hciAclCback_t</a> callback. HCI allocates the WSF buffer pointed to by pData. The stack is responsible for deallocating the buffer. The ACL packet is formatted as defined the <em>Bluetooth</em> <em>Core</em> <em>Specification</em> document:</p><ul>
<li>The first two bytes of the buffer contain the handle for the ACL connection.</li>
<li>The next two bytes of the buffer contain the length.</li>
</ul>
<p>ACL data manages flow control with the <a class="el" href="group___s_t_a_c_k___h_c_i___a_c_l___a_p_i.html#ga9617c42a204bbf6801c2a24dfd0e9192">hciFlowCback_t</a> callback. If parameter flowDisabled is TRUE then the stack cannot send ACL data to HCI. If flowDisabled is FALSE then data flow can resume on the specified connection handle.<br />
<br />
 See <a class="el" href="group___s_t_a_c_k___h_c_i___a_c_l___a_p_i.html">HCI ACL Data Interface</a> for API.</p>
<h1><a class="anchor" id="HCI_USAGE"></a>
Usage Scenarios</h1>
<h2><a class="anchor" id="HCI_USAGE_RESET"></a>
Reset</h2>
<p>Figure 3 shows the operation of the reset sequence.</p><ol type="1">
<li>The DM subsystem of the stack calls <a class="el" href="group___s_t_a_c_k___h_c_i___i_n_i_t___a_p_i.html#ga9d39d641feb37f7d21a0c709906e5b55" title="Initiate an HCI reset sequence. ">HciResetSequence()</a> to initiate the reset sequence.</li>
<li>HCI begins sending a sequence of HCI commands to the controller, starting with the HCI Reset command.</li>
<li>After each command a Command Complete event is received.</li>
<li>HCI continues sending commands until it has sent all the commands in its sequence.</li>
<li>When it has received a Command Complete event for the last command it calls the event callback and sends a Reset Sequence Complete event.</li>
</ol>
<div class="image">
<img src="operation_hci_reset.png" alt="operation_hci_reset.png"/>
<div class="caption">
Figure 3. Reset</div></div>
 <h2><a class="anchor" id="HCI_USAGE_CMDEVT"></a>
HCI Command and Event</h2>
<p>Figure 4 shows an HCI command and event.</p><ol type="1">
<li>The DM subsystem of the stack calls an HCI function to create a connection.</li>
<li>HCI sends an LE Create Connection command to the controller.</li>
<li>The controller responds with a Command Status event. Note: This event is not sent to the stack; it is processed internally by HCI.</li>
<li>The controller sends an LE Connection Complete event.</li>
<li>HCI calls the event callback and sends an LE Connection Complete event to the stack.</li>
</ol>
<div class="image">
<img src="operation_hci_cmdevt.png" alt="operation_hci_cmdevt.png"/>
<div class="caption">
Figure 4. HCI Command and Resulting Event</div></div>
 <h2><a class="anchor" id="HCI_USAGE_ACL"></a>
ACL Data Transmit and Receive</h2>
<p>Figure 5 shows ACL data transmit and receive.</p><ol type="1">
<li>The L2CAP layer of the stack calls function <a class="el" href="group___s_t_a_c_k___h_c_i___a_c_l___a_p_i.html#gaeba76cd2310f3de5f92aef2f55e38d38" title="Send ACL Data from the stack to HCI. ">HciSendAclData()</a> to send data from the stack to HCI.</li>
<li>HCI builds and sends an ACL data packet to the controller.</li>
<li>The controller then sends a Number of Completed Packets event to HCI and HCI processes this event internally without passing it to the stack.</li>
</ol>
<p>For receive data, the controller sends an ACL data packet to HCI, processes the packet and calls the ACL data callback to send the packet to L2CAP.</p>
<div class="image">
<img src="operation_hci_acl.png" alt="operation_hci_acl.png"/>
<div class="caption">
Figure 5. Data Transmit and Receive</div></div>
<p><br />
</p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<ul>
<table width="100%">
    <tr>
        <td align="left" valign="middle">Copyright &copy; 2017-2018 Arm Ltd. All rights reserved.</td>
        <td align="center" valign="middle">Arm Confidential</td>
        <td align="right" valign="middle">Cordio Stack and Cordio Profiles</td>
    </tr>
</table>
</ul>
</div>
</body>
</html>
